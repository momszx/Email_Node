<script type="text/javascript">
    RED.nodes.registerType('microsoft-email',{
        category: 'Scepiconsulting custom nodes',
        color: '#a6bbcf',
        defaults: {
            name: {value:""}
        },
        inputs: 1,
        outputs: 0,
        icon: "envelope.svg",
        label: function() {
            return this.name||"microsoft-email";
        },
        credentials: {
            clientId: {type:"text"},
            tenantId: {type:"text"},
            clientSecret: {type:"password"}
        },
    });
</script>

<script type="text/html" data-template-name="microsoft-email">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-clientId"><i class="fa fa-tag"></i> ClientId</label>
        <input type="text" id="node-input-clientId">
    </div>
    <div class="form-row">
        <label for="node-input-tenantId"><i class="fa fa-tag"></i> TenantId</label>
        <input type="text" id="node-input-tenantId">
    </div>
    <div class="form-row">
        <label for="node-input-clientSecret"><i class="fa fa-tag"></i> Client Secret</label>
        <input type="password" id="node-input-clientSecret">
    </div>
</script>


<script type="text/html" data-help-name="microsoft-email">
    <p>A Node-RED node that sends an email using Microsoft Graph API.</p>
    <p>This node requires the following parameters in the input message payload:</p>
    <ul>
        <li><strong>clientId</strong>: The client ID of your Azure AD app.</li>
        <li><strong>clientSecret</strong>: The client secret of your Azure AD app.</li>
        <li><strong>tenantId</strong>: The ID of your Azure AD tenant.</li>
        <li><strong>userEmail</strong>: The email address of the user to send the email to.</li>
        <li><strong>subject</strong>: The subject of the email.</li>
        <li><strong>body</strong>: The HTML content of the email body.</li>
        <li><strong>address</strong>: The email address to send the email from.</li>
    </ul>
    <p>Make sure to configure the Microsoft Graph API permissions and provide valid input for the node to work properly.</p>
    <p>For more information, refer to the Microsoft Graph API documentation: <a href="https://docs.microsoft.com/en-us/graph/" target="_blank">Microsoft Graph API</a></p>
</script>
